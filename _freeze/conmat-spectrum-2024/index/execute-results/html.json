{
  "hash": "b6ba96a9db0bd936d356e5fa3e2d9931",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"`conmat`: Programmatic generation of synthetic contact matrices\"\nauthor: M. J. Lydeamore\ndate: today\nformat:\n    presentation-revealjs+letterbox:\n        fig-align: center\n---\n\n::: {.cell}\n<style type=\"text/css\">\nfigcaption {\n    text-align: center;\n}\n\n.center {\n  text-align: center;\n}\n</style>\n:::\n\n::: {.cell}\n\n:::\n\n\n![](images/massiveplug.webp){fig-align=\"center\"}\n\n::: {.fragment}\n### Open the World with Open Source {.center}\n\nLearn and discuss new open source tools for business analytics and data science!\n\n#### Register at [https://wombat2024.numbat.space/](https://wombat2024.numbat.space/) {.center}\n:::\n\n\n## What are contact matrices\n\n* Estimates of the numbers of contact between individuals in various categories\n* Used in models to investigate:\n  * Effect of NPIs\n  * Understand effects of demographic changes\n  * \"More accurately\" estimate transmission\n\n::: {.fragment}\nBut how do they come about!?\n:::\n\n\n## Contact diary studies\n\nContact diary studies follow individuals and ask them:\n\n* how many contacts of a certain type, \n* the duration of contact,\n* the location of the contact,\n* the frequency of the contact\n\n::: {.fragment}\nThey are undoubtedly the gold standard for data on the number of contacts.\n\nBut they are prohibitively expensive, and logistically very challenging.\n:::\n\n## POLYMOD\n\nPublished in 2008, Mossong et. al undertook a contact diary study of 7290 participants across Europe.\n\n_It remains the most widely cited contact diary study_.\n\n![](images/mossong-combined.png){fig-align=\"center\"}\n\n## Contact matrix projection\n\nPrem et. al formed a model that predicts the number of contacts based on the age structure of the population.\n\nThis model then allows for prediction to settings that are outside the original POLYMOD countries.\n\n## What is provided:\n\n::: {.columns}\n::: {.column width='50%'}\n![](images/prem-dir-mats.png){fig-align=\"center\"}\n\n:::\n::: {.column width='50%'}\n![](images/prem-spreadsheet.png){fig-align=\"center\"}\n\n:::\n:::\n\n## Our model of contact\n\nNot much information to train model. We model the number of contacts an individual in bin $i$ has with bin $j$:\n\n$$\\begin{aligned}\nc_{ij} = \\beta_{0,i} + \\beta_1(|i-j|) + &\\beta_2(|i-j|^2) + \\beta_3(i\\times j) + \\beta_4(i+j) +\\\\ &\\beta_5\\max(i, j) + \\beta_6\\min(i, j)\n\\end{aligned}\n$$\n\n::: {.fragment .callout-tip}\n## ðŸ¤“ Akshually ðŸ¤“\n\nWe want to fit this as a generalised additive model, so _actually_ we have splines on these terms to satisfy the smoothness requirements.\n\nThis is very similar to the approach by Prem et. al who perform post-hoc smoothing of the parameters after MCMC.\n:::\n\n## Model terms\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](index_files/figure-revealjs/unnamed-chunk-3-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n## Projection onto target demography\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](index_files/figure-revealjs/partial-plots-create-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n## Importance of contact diary study\n\nWe've used POLYMOD-trained models for over a decade.\n\nThere are 44 other surveys available in one collection on [Zenodo](https://zenodo.org/communities/social_contact_data/records), and probably more out there in the wild.\n\n::: {.fragment}\nSome recent work from [Harris et. al](https://arxiv.org/abs/2406.01639) has shown that differences in the survey design can have a significant impact on these synthetic contact matrices.\n:::\n\n::: {.fragment .callout-tip}\n`conmat` allows for training on survey of choice, and projection onto target demographic of choice\n:::\n\n## Example of using a different study {auto-animate=\"true\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchina_survey <- socialmixr::get_survey(\"https://doi.org/10.5281/zenodo.3878754\") |>\n    summarise(contacts = sum(cnt_home))\n\nchina_pop <- read_csv(\"./data/china_pop_age_dist.csv\")\nchina_pop_cm <- conmat::as_conmat_population(\n  data = china_pop,\n  age = lower.age.limit,\n  population = population\n)\n```\n:::\n\n\n\n## Example of using a different study {auto-animate=\"true\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchina_survey <- socialmixr::get_survey(\"https://doi.org/10.5281/zenodo.3878754\") |>\n    summarise(contacts = sum(cnt_home))\n\nchina_pop <- read_csv(\"./data/china_pop_age_dist.csv\")\nchina_pop_cm <- conmat::as_conmat_population(\n  data = china_pop,\n  age = lower.age.limit,\n  population = population\n)\n\nmodel <- conmat::fit_single_contact_model(\n    contact_data = china_survey,\n    population = china_pop_cm\n)\n\npredicted_contacts <- conmat::predict_contacts(\n    model = model,\n    population = china_pop_cm,\n    age_breaks = c(seq(0, 80, by = 5), Inf)\n)\n```\n:::\n\n\n## Why input survey matters\n\nThese matrices are for a Chinese population, using a Chinese survey (left) and POLYMOD (right), for the home setting.\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](index_files/figure-revealjs/unnamed-chunk-7-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n## Why input survey matters\n\nThese matrices are for a Chinese population, using a Chinese survey (left) and POLYMOD (right), for the home setting.\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](index_files/figure-revealjs/unnamed-chunk-8-1.png){fig-align='center' width=960}\n:::\n:::\n\n\n## Summary\n\n`conmat` is a new, open-source, programmable system to generate synthetic contact matrices\n\n::: {.incremental}\n* Can use arbitrary contact survey and arbitrary demography\n* Convenience functions for next generation matrices, numbers of contacts\n* Choice of input survey _is crucial_:\n    * These models have no information on terms like \"intergenerational mixing\"\n:::\n\n## Summary\n\n`conmat` is a new, open-source, programmable system to generate synthetic contact matrices\n\nAvailable right now:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nremotes::install_github(\"idem-lab/conmat\")\n```\n:::\n\n\nor pre-computed matrices on Zenodo: [https://zenodo.org/records/12776714](https://zenodo.org/records/12776714)\n\n## Acknowledgements\n\n::: {layout-nrow=1}\n\n![Chitra Saraswati](images/chitra-saraswati.png)\n\n![Aarathy Babu](images/aarathy-babu.jpg)\n\n![Nick Tierney](images/nick-tierney.jpg)\n\n![Nick Golding](images/nick-golding.jpg)\n\n:::\n\nSPECTRUM-SPARK Seed Funding\n\n::: footer\n\nCode and slides are available at [https://github.com/MikeLydeamore/talk-conmat-projections](https://github.com/MikeLydeamore/talk-conmat-projections)\n\n:::",
    "supporting": [
      "index_files/figure-revealjs"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}